#!/bin/bash

_volume_info() {
    amixer -D pulse get Master
}

cmd_base="dunstify -a $(basename "$0") -r 999002 -u low -t 1000"

case "$1" in
    --mute)
        amixer -D pulse set Master 1+ toggle
        if _volume_info | rg -qw "on"; then
            $cmd_base "Unmuted"
        else
            $cmd_base "Muted"
        fi
        ;;

    --set)
        amixer -D pulse set Master "$2"
        level=$(_volume_info | rg -o "(\d+%)" | head -n1)
        $cmd_base -h int:value:"$level" "Volume: ${level}"
        ;;

    *)
        echo "Unknown command '$1'." && exit 1
        ;;
esac
